This final film in this phase of the Marvel Cinematic Universe wraps up years of storytelling, and its content is pretty par for the course for these movies, with many action sequences and battle scenes. The film moves between various locations that will be familiar to viewers, including a destroyed New York City and other planets, and a major war scene continues the preceding film, “Infinity War.” Countless characters die or disappear; there is some particularly brutal violence, including a character’s beheading, one who is shot, and another character who we see at the bottom of the cliff; and various fan favorites die. There is some cursing, some sexually themed joking, and some kissing, and characters spend years grieving loved ones who have died.

How to wrap up years of storytelling for a group of characters whose personalities we’ve seen grow and evolve over time, whose loyalties have shifted and changed, whose relationships have transformed from alliances into rivalries and back again? The Marvel Cinematic Universe has done so much with the Avengers characters over more than 20 preceding films, and broken so many viewers’ hearts with the Snap in “Infinity War,” that “Endgame” is facing almost impossibly high expectations.

Some of it is great, some of it is good, and some of it is tedious. All in all, coming in at over three hours, “Endgame” effectively wraps up the MCU’s first phase of storytelling in a way that opens up new paths for the future of this franchise. Since 2008, as we’ve progressed from “Iron Man” to “The Incredible Hulk” to “Thor” to “Captain America: The First Avenger,” we’ve seen Tony Stark (Robert Downey Jr.), Steve Rogers (Chris Evans), Bruce Banner (Mark Ruffalo), Thor (Chris Hemsworth), and Natasha Romanoff/Black Widow (Scarlett Johansson) and Clint Barton/Hawkeye (Jeremy Renner) battle alien invasions, terrorists, and ghosts from their past. We saw the group split apart in “Civil War,” and then come together in “Infinity War,” and when “Endgame” begins, they’re united in grief.

With exactly 50% of the world’s population erased out of existence thanks to Thanos’s (Josh Brolin) “Snap,” the Avengers are scattered. Tony is stuck on a spaceship. Nat and Steve are back on Earth, trying to continue the mission of S.H.I.E.L.D. and prevent further bloodshed around the world. Bruce is attempting to accept his Hulk persona in a way that will benefit his life, not hinder it. Thor and Clint are in isolation. And the possibility that they can come together to find a way and fight Thanos, or reverse what happened, seems increasingly remote with each passing day. At some point, will it disappear?

“Endgame” spends its first hour or so acquainting viewers with what happened in “Infinity War” and digging deep into the survivors’ guilt the remaining Avengers are feeling, from Nebula (Karen Gillan), who lost her sister Gamora (Zoe Saldana) to their father, Thanos, to Thor, who is in disbelief over the death of so many of his people, the Asgardians. Tony wants to lead a normal life. Nat is cracking under the pressure. Clint has become a renegade. And yet the team slowly starts coming back together, at a pace that feels drawn out—you’ll sense every minute of the film’s three-hour-plus run time—but that pays attention to nearly every character.

There is a lot happening in this film, with countless moving parts, and “Endgame” is obsessed with what came before. Pivotal scenes and plot occurrences from preceding Marvel films matter here. Character decisions from the past reverberate through to the present film. The action sequences are vast in scale and create certain moments from the comic book source material that are wonderfully picturesque on screen. Although the subject matter can be quite dark, the mood is often light thanks to inherently good-natured characters like Paul Rudd’s Scott Lang/Ant-Man. There are Easter eggs throughout for fans to spot, and the narrative is so self-referential that sometimes the movie seems like it’s too focused backward rather than forward. But the last 45 minutes or so are a nonstop bonanza, with moments that pay homage to nearly every Avenger and their unique abilities.

“Endgame” has a lot to do, and it does include missteps; some of its characters are disserved with exits that don’t have as much emotional impact as they should. But on the other hand, a few others get such a perfect goodbye that you can’t help but react; it would be nearly unfathomable to have spent more than 20 preceding films with these characters and not feel anything at the end of “Endgame.” It is an undeniable spectacle, an achievement that I’m not sure can be recreated again, the conclusion of a certain kind of moviemaking that has changed the blockbuster landscape. “Avengers: Endgame” is not a perfect conclusion, but a satisfying one that does more than enough to make you wonder where the Marvel Cinematic Universe goes next.